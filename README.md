# MalwareScanner
A simple program that mimics anti-virus behaviour, written in C++ using windows API.

In general, the idea is to calculate hash on a file and compare it to a known hash database of suspicious programs. 
The scanner receives as argument directory path to start the scan from. It iterates (recursivly) over all the files and checking them. Once there is a match (the calculated hash exists in the database) a message box will pop showing the path to the malware and then delete the file. 

In addition, it scans all the processes. If a suspicious process has been found (runs a file with known signature) it will terminate the process and just then delete the file.

Scanner skips files with size above 10mb. Supports ignoring extensions, so scanner will skip txt, doc, pdf, etc. (Can change these during initialize).

## VirusTotal
There is an option to supply VirusTotal API Key, and then the scanner will send a query to VT. Once analysis is done, file will be deleted if 'positives' (times the file flagged as malware) is positive. 

There isn't API for c++ So I wrote a python script that does that. The program runs the python script and waits for analysis results. It prompts the user with the analysis response (positive our of total number of scans done in VT).

## Hash
Hashing could be done with MD5, but the obvious disadvantage of it is the a minor change in the file yields a completely new hash. Instead, the scanner uses fuzzy hash utilized in ssdeep (https://github.com/ssdeep-project/ssdeep) which is good at comparing binaries.
Further reading on fuzzy hash vs. MD5: https://www.techrepublic.com/blog/it-security/fuzzy-hashing-helps-researchers-spot-morphing-malware/

## Usage
MalwareScanner.exe "[directory name]" [Optional- VirusTotal API Key] - quotes for directories with spaces.
- Directories that include Hebrew characters are not supported.

## Compilation
g++ -std=c++11 main.cpp Scanner.cpp include/fuzzy.c -lpsapi -o MalwareScanner.exe

- Links with psapi lib for 'GetModuleFileNameEx'.
