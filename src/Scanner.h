#ifndef MALWARESCANNER_SCANNER_H
#define MALWARESCANNER_SCANNER_H
#include <windows.h>
#include <psapi.h> //For GetModuleFileNameEx
#include <vector>
#include <string>
#include <iostream>
#include <fstream>

using namespace std;
class Scanner
{
public:
    Scanner(const char* apiKey);
    ~Scanner() = default;

    BOOL ScanFile(LPCSTR fileName, BOOL deleteFlag = FALSE);
    void ScanDirectory(LPCSTR dirName);
    void ScanProcesses();
private:
    //CHANGE TO CSV FILE
    vector<const char*> vSigs;			        // Hash database to compare with
    vector<const char*> vExtensions;	    // Extensions not to scan
    const char* apiKey; // API Key for VirusTotal analysis

    void CheckProcess(DWORD processID);
    void CheckVirusTotal(const char* fileName, int* analysisResult);
    void PrintVirusTotalResult(int* analysisResult);
};
#endif //MALWARESCANNER_SCANNER_H
