import sys
import requests
import time

file_name = sys.argv[1]
api_key = sys.argv[2]
url = 'https://www.virustotal.com/vtapi/v2/file/scan'
params = {'apikey': api_key}
files = {'file': (file_name, open(file_name, 'rb'))}
response = requests.post(url, files=files, params=params)
scan_id = response.json()['scan_id']


url = 'https://www.virustotal.com/vtapi/v2/file/report'
params = {'apikey': api_key, 'resource': scan_id}
while True:
	response = requests.get(url, params=params)
	if response is not None:
		result = response.json()
		if result['response_code'] == 1:
			break
	time.sleep(60) #Wait for analysis
with open("temp.txt", "w") as f:
	f.write(str(result['total']) + "\n")
	f.write(str(result['positives']) + "\n")
	

	